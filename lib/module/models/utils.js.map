{"version":3,"sources":["utils.ts"],"names":["t","pipe","fold","left","prettyReporter","onLeft","errors","Error","report","join","decode","codec","value","decoded","optional","union","undefined"],"mappings":"AAAA,OAAO,KAAKA,CAAZ,MAAmB,OAAnB;AACA,SAASC,IAAT,QAAqB,gBAArB;AACA,SAASC,IAAT,EAAeC,IAAf,QAA2B,cAA3B;AACA,OAAOC,cAAP,MAA2B,iBAA3B,C,CAEA;;AACA,MAAMC,MAAM,GAAIC,MAAD,IAAsB;AACnC,QAAM,IAAIC,KAAJ,CACH,iBAAgBH,cAAc,CAACI,MAAf,CAAsBL,IAAI,CAACG,MAAD,CAA1B,EAAoCG,IAApC,CAAyC,IAAzC,CAA+C,EAD5D,CAAN;AAGD,CAJD;AAMA;AACA;AACA;;;AACA,OAAO,MAAMC,MAAM,GAAG,CAAIC,KAAJ,EAAkCC,KAAlC,KAAwD;AAC5E,SAAOX,IAAI,CACTU,KAAK,CAACD,MAAN,CAAaE,KAAb,CADS,EAETV,IAAI,CAACG,MAAD,EAASQ,OAAO,IAAIA,OAApB,CAFK,CAAX;AAID,CALM;AAOP;AACA;AACA;AACA;;AACA,OAAO,MAAMC,QAAQ,GAAOH,KAAJ,IACtBX,CAAC,CAACe,KAAF,CAAQ,CAACJ,KAAD,EAAQX,CAAC,CAACgB,SAAV,CAAR,CADK;AAGP","sourcesContent":["import * as t from 'io-ts'\nimport { pipe } from 'fp-ts/function'\nimport { fold, left } from 'fp-ts/Either'\nimport prettyReporter from 'io-ts-reporters'\n\n// failure handler\nconst onLeft = (errors: t.Errors) => {\n  throw new Error(\n    `DecodeError:\\n${prettyReporter.report(left(errors)).join('\\n')}`\n  )\n}\n\n/**\n * Throws when decode fails\n */\nexport const decode = <T>(codec: t.Decoder<unknown, T>, value: unknown): T => {\n  return pipe(\n    codec.decode(value),\n    fold(onLeft, decoded => decoded)\n  )\n}\n\n/**\n * for an optional field\n * T | undefined\n */\nexport const optional = <T>(codec: t.Type<T, any, any>) =>\n  t.union([codec, t.undefined])\n\n/** Util Types ==================================================================**/\nexport type Without<T> = { [P in keyof T]?: undefined }\nexport type XOR<T, U> = (Without<T> & U) | (Without<U> & T)\n"]}