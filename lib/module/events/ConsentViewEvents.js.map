{"version":3,"sources":["ConsentViewEvents.ts"],"names":["NativeEventEmitter","NativeModules","Platform","consentViewErrorCodec","consentViewInfoCodec","decode","IronSourceMediation","CONSENT_VIEW_DID_LOAD_SUCCESS","CONSENT_VIEW_DID_FAIL_TO_LOAD","CONSENT_VIEW_DID_SHOW_SUCCESS","CONSENT_VIEW_DID_FAIL_TO_SHOW","CONSENT_VIEW_DID_ACCEPT","getConstants","eventEmitter","NotIOS","OS","NonIOSStub","setListener","_","console","error","removeListener","consentViewDidLoadSuccess","listener","removeAllListeners","addListener","consentViewInfoObj","consentViewType","consentViewDidFailToLoad","errorObj","consentViewDidShowSuccess","consentViewDidFailToShow","consentViewDidAccept","ConsentViewEvents"],"mappings":"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","sourcesContent":["import { NativeEventEmitter, NativeModules, Platform } from 'react-native'\nimport { ConsentViewError, consentViewErrorCodec } from '../models'\nimport { consentViewInfoCodec } from '../models/ConsentViewInfo'\nimport { decode } from '../models/utils'\n\n// The Main Module\nconst { IronSourceMediation } = NativeModules\n// Event Name Constants defined on iOS platform\n// These would be undefined on Android.\nconst {\n  CONSENT_VIEW_DID_LOAD_SUCCESS,\n  CONSENT_VIEW_DID_FAIL_TO_LOAD,\n  CONSENT_VIEW_DID_SHOW_SUCCESS,\n  CONSENT_VIEW_DID_FAIL_TO_SHOW,\n  CONSENT_VIEW_DID_ACCEPT,\n} = IronSourceMediation.getConstants()\n\n// Create an EventEmitter to subscribe to ConsentView delegate callbacks\nconst eventEmitter = new NativeEventEmitter(IronSourceMediation)\n\n// Stub out for Android\nconst NotIOS = Platform.OS !== 'ios'\nconst NonIOSStub = {\n  setListener: (_: any) => console.error('Only supported for iOS.'),\n  removeListener: () => console.error('Only supported for iOS.'),\n}\n\n/**\n * iOS 14 ConsentView events API\n * Only fired on iOS\n */\n\n/**\n * Android: n/a\n *     iOS: consentViewDidLoadSuccess\n */\nconst consentViewDidLoadSuccess = NotIOS\n  ? NonIOSStub\n  : {\n      setListener: (listener: (consentViewType: string) => void) => {\n        eventEmitter.removeAllListeners(CONSENT_VIEW_DID_LOAD_SUCCESS)\n        eventEmitter.addListener(\n          CONSENT_VIEW_DID_LOAD_SUCCESS,\n          (consentViewInfoObj: unknown) => {\n            const { consentViewType } = decode(\n              consentViewInfoCodec,\n              consentViewInfoObj\n            )\n            listener(consentViewType)\n          }\n        )\n      },\n      removeListener: () =>\n        eventEmitter.removeAllListeners(CONSENT_VIEW_DID_LOAD_SUCCESS),\n    }\n\n/**\n * Android: n/a\n *     iOS: consentViewDidFailToLoadWithError\n */\nconst consentViewDidFailToLoad = NotIOS\n  ? NonIOSStub\n  : {\n      setListener: (listener: (error: ConsentViewError) => void) => {\n        eventEmitter.removeAllListeners(CONSENT_VIEW_DID_FAIL_TO_LOAD)\n        eventEmitter.addListener(\n          CONSENT_VIEW_DID_FAIL_TO_LOAD,\n          (errorObj: unknown) =>\n            listener(decode(consentViewErrorCodec, errorObj))\n        )\n      },\n      removeListener: () =>\n        eventEmitter.removeAllListeners(CONSENT_VIEW_DID_FAIL_TO_LOAD),\n    }\n\n/**\n * Android: n/a\n *     iOS: consentViewDidShowSuccess\n */\nconst consentViewDidShowSuccess = NotIOS\n  ? NonIOSStub\n  : {\n      setListener: (listener: (consentViewType: string) => void) => {\n        eventEmitter.removeAllListeners(CONSENT_VIEW_DID_SHOW_SUCCESS)\n        eventEmitter.addListener(\n          CONSENT_VIEW_DID_SHOW_SUCCESS,\n          (consentViewInfoObj: unknown) => {\n            const { consentViewType } = decode(\n              consentViewInfoCodec,\n              consentViewInfoObj\n            )\n            listener(consentViewType)\n          }\n        )\n      },\n      removeListener: () =>\n        eventEmitter.removeAllListeners(CONSENT_VIEW_DID_SHOW_SUCCESS),\n    }\n\n/**\n * Android: n/a\n *     iOS: consentViewDidFailToShowWithError\n */\nconst consentViewDidFailToShow = NotIOS\n  ? NonIOSStub\n  : {\n      setListener: (listener: (error: ConsentViewError) => void) => {\n        eventEmitter.removeAllListeners(CONSENT_VIEW_DID_FAIL_TO_SHOW)\n        eventEmitter.addListener(\n          CONSENT_VIEW_DID_FAIL_TO_SHOW,\n          (errorObj: unknown) =>\n            listener(decode(consentViewErrorCodec, errorObj))\n        )\n      },\n      removeListener: () =>\n        eventEmitter.removeAllListeners(CONSENT_VIEW_DID_FAIL_TO_SHOW),\n    }\n\n/**\n * Android: n/a\n *     iOS: consentViewDidAccept\n */\nconst consentViewDidAccept = NotIOS\n  ? NonIOSStub\n  : {\n      setListener: (listener: (consentViewType: string) => void) => {\n        eventEmitter.removeAllListeners(CONSENT_VIEW_DID_ACCEPT)\n        eventEmitter.addListener(\n          CONSENT_VIEW_DID_ACCEPT,\n          ({ consentViewType }: { consentViewType: string }) =>\n            listener(consentViewType)\n        )\n      },\n      removeListener: () =>\n        eventEmitter.removeAllListeners(CONSENT_VIEW_DID_ACCEPT),\n    }\n\nconst removeAllListeners = () => {\n  consentViewDidLoadSuccess.removeListener()\n  consentViewDidFailToLoad.removeListener()\n  consentViewDidShowSuccess.removeListener()\n  consentViewDidFailToShow.removeListener()\n  consentViewDidAccept.removeListener()\n}\n\nexport const ConsentViewEvents = {\n  consentViewDidLoadSuccess,\n  consentViewDidFailToLoad,\n  consentViewDidShowSuccess,\n  consentViewDidFailToShow,\n  consentViewDidAccept,\n  removeAllListeners,\n}\n"]}